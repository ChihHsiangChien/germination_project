# 咸豐草發芽實驗設計與統計分析 (Experiment Design & Statistical Analysis)

本文件詳述「咸豐草瘦果發芽自動化監測」實驗的統計設計、數據指標、以及後續建議使用的進階分析模型。

---

## 🧪 實驗設計：隨機區集設計 (RCBD)

本實驗採用 **隨機區集設計 (Randomized Complete Block Design, RCBD)**，以確保環境變異（如不同盤子的微氣候差異）能被統計模型抵銷。

### 1. 統計術語對照
*   **因子 (Factor)**：瘦果的處理方式。
*   **處理 (Treatments)**：共有 2 組。
    *   **去芒組 (Treated)**：去除冠芒的瘦果。
    *   **未去芒組 (Untreated)**：保有冠芒的瘦果（對照組）。
*   **區集 (Block)**：
    *   **實驗一 (紙巾發芽)**：4 個盤子 (Dish A~D)。每個區集包含 15 顆去芒、15 顆未去芒。總樣本數 $N = 120$ ($30 \text{ 顆} \times 4 \text{ 盤}$)。
    *   **實驗二 (覆土出苗)**：5 個盤子 (Dish A~E)，每盤 12 個穴孔 (Cells)，每穴 4 顆種子。每個區集包含 24 顆去芒、24 顆未去芒。總樣本數 $N = 240$ ($48 \text{ 顆} \times 5 \text{ 盤}$)。
*   **重複 (Replicates)**：實驗區集數即為重複次數（實驗一 4 次，實驗二 5 次）。

---

## 📊 關鍵數據指標

利用自動化影像監測獲得的高頻率數據，可計算以下指標：

1.  **最終發芽率 (Final Germination Percentage)**
    $$\frac{\text{最終發芽種子數}}{\text{總種子數}} \times 100\%$$
2.  **中位發芽時間 (Median Germination Time, $T_{50}$)**
    剛好 50% 種子發芽所需的精確分鐘數。這是衡量發芽速度最公平的指標。
3.  **發芽速率指數 (Germination Rate Index)**
    衡量單位時間內發芽數量的動態指標。
4.  **自由度 (Degrees of Freedom)**
    *   處理自由度 ($df_{treatment}$) = $2 - 1 = 1$
    *   區集自由度 ($df_{block}$) = $\text{盤數} - 1$ (實驗一為 3，實驗二為 4)
    *   誤差自由度 ($df_{error}$) = $df_{treatment} \times df_{block}$ (實驗一為 3，實驗二為 4)

---

## 🔬 進階統計模型建議

由於監測頻率高達 **每 5 分鐘一次**，數據解析度極高，建議採用以下模型：

### 1. 邏輯斯迴歸 (Logistic Regression / GLM)
適用於分析「最終發芽與否」。
*   **隨機成分**：二項分佈 (Binomial)。
*   **連結函數**：Logit。
*   **優點**：確保預測值介於 0 與 1 之間，並可算出**勝算比 (Odds Ratio)**。
*   **公式**：$\ln\left(\frac{p}{1-p}\right) = \beta_0 + \beta_1 X_{treatment} + \beta_2 X_{dish}$
*   **預測機率 ($p$) 的還原計算**：
    若令迴歸方程式等號右邊的總和為 $Z$ (即 $Z = \beta_0 + \beta_1 X_{treatment} + \beta_2 X_{dish}$)，
    則預測的發芽機率 $p$ 可透過「反對數 (Inverse Logit)」推導得出：
    $$p = \frac{e^Z}{1 + e^Z} = \frac{1}{1 + e^{-Z}}$$

### 2. 生存分析 (Survival Analysis)
這是本實驗最推薦的方法，因為它能處理隨時間變化的「發芽機率」。

#### A. 卡普蘭-梅爾估計 (Kaplan-Meier Estimate)
*   **用途**：繪製累積發芽曲線（階梯函數）。
*   **優點**：能處理「設限數據 (Censoring)」，即實驗結束時仍未發芽的種子資訊。
    *   **實驗長度 (設限時間) 的動態判定**：本系統的 R 分析腳本採用**動態終點**判定法。它會自動抓取表格中「最晚發芽那顆種子的時間，再往後推 24 小時」作為該次實驗的公定大限。若全數未發芽，則預設為 14 天。這些到大限前都未發芽（設限資料，Status=0）的種子，會被演算法正確地視為整個觀察期內的「機率分母（母體陪跑員）」繼續計算，避免了傳統平均數直接剔除失敗種子所造成的存活率高估。
*   **對數秩檢定 (Log-rank Test)**：用 P 值判定兩組發芽曲線是否具有顯著差異。

#### B. Cox 比例風險模型 (Cox Proportional Hazards Model)
*   **用途**：計算**風險比 (Hazard Ratio, HR)**，精確衡量「處理（去芒）」這件事為種子發芽帶來的「倍數效應」。
*   **與一般迴歸的差異**：GLM (羅吉斯迴歸) 分析的是「最終結果（發芽與否）」，而 Cox 模型分析的是「**時間與發生機率的動態關係（Hazard）**」。在任何一個微小的時間點上，一顆還沒發芽的種子，它「剛好在下一秒發芽」的瞬間機率，就稱為 Hazard。
*   **隔離環境變異的強大武器 (`strata`)**：在 R 腳本裡我們刻意使用了 `strata(Dish)` 語法。這代表我們允許每一個培養皿擁有自己「完全獨特、形狀詭異的基礎發芽曲線」（比如 Dish A 放在風口水乾得快，基礎發芽率本來就差），但是模型會強制在這些不同的環境背景下，抽出純粹的「處理效應」並評估「去芒」這個動作是不是在所有盤子裡，都穩定貢獻了某個常數倍的發芽動能。這種「分層 (Stratification)」技巧是生統上控制「區集誤差（環境干擾）」的最嚴謹作法。

---

## 💻 R 語言分析範例

### 數據準備格式 (範例)
| Dish_ID | Cell | Treatment | Status (1=發生, 0=未發生) | Time (小時) |
| :------ | :--- | :-------- | :------------------------ | :---------- |
| Dish_A  | --   | Treated   | 1                         | 72          |
| Dish_A  | --   | Untreated | 0                         | 336         |

### 分析程式碼
```R
library(survival)
library(survminer)

# 1. 進行廣義線性模型 (GLM) 分析最終發芽率
logit_model <- glm(Status ~ Treatment + Tray, family = binomial(link = "logit"), data = df)
summary(logit_model)

# 2. 建立生存物件並繪製 Kaplan-Meier 曲線
surv_obj <- Surv(time = df$Time, event = df$Status)
fit_km <- survfit(surv_obj ~ Treatment, data = df)

ggsurvplot(fit_km, fun = "event", risk.table = TRUE, 
           title = "Cumulative Germination Curves",
           xlab = "Time (Minutes)", ylab = "Probability")

# 3. 進行 Cox 回歸分析 (考慮盤子效應)
fit_cox <- coxph(surv_obj ~ Treatment + strata(Dish), data = df)
summary(fit_cox)
```

---

## 💡 為什麼高頻率監測 (5 min/frame) 很重要？
*   **斜率分析**：能觀察發芽的「爆發期」斜率。
*   **生理效率**：精準捕捉 $T_{50}$ 的差異，而非僅是「天」級的粗略觀測。
*   **動態過程**：能證明處理是否導致了發芽時間的「提前」或「同步化」。
---

## 📈 統計報告導讀 (Reporting Interpretation Guide)

當您執行完 R 腳本並獲得 `comprehensive_report.txt` 時，請參考以下指南進行科學解讀。

### 1. 百分位發芽時間 ($T_{25}$, $T_{50}$) —— 「速度」指標
*   **$T_{50}$**：代表該組有 **50%** 的種子發芽的時間點。
*   **$T_{25}$**：代表 **25%** 種子發芽的時間點。
*   **為何會出現 `NA`？**
    *   若該組最終發芽率未達到 50%（或 25%），統計模型無法給出確切時間。
    *   **對策**：在實驗早期或低發芽率下，$T_{25}$ 是判斷「誰起跑得比較快」的重要依據。

```markdown
### 2. 平均指標 —— 「動能」與「候時」指標
*   **發芽速率指數 (GRI)**：數值越高，代表該組發芽動能越強、整體越整齊。
    *   **計算方式**：$\sum \frac{g_i}{t_i}$ ($g_i$ 為各時間點新增的發芽百分比，$t_i$ 為該時間點)。這是不受發芽率限制的穩定指標。
*   **平均發芽時間 (MGT)**：**僅計算已發芽的種子**。
    *   **計算方式**：$\frac{\sum (n_i \times t_i)}{\sum n_i}$ ($n_i$ 為各時間點新增的發芽數，$t_i$ 為該時間點)。
    *   這回答了：「在那幾顆會發芽的種子中，平均要等多久？」
```

### 3. P 值 (P-value) —— 「顯著性」判定
*   **門檻**：通常以 **0.05** 為界。
    *   **P < 0.05**：顯著差異。結論可宣稱「去芒處理確實改變了種子的行為」。
    *   **P > 0.05**：無顯著差異。目前證據不足以說明處理有效。
*   **報告中兩種 P 值的區別**：
    *   **GLM P 值**：判定「**最終發芽總數**」有沒有差。
    *   **Log-rank P 值**：判定「**整段發芽曲線與速度**」有沒有差。

### 4. 風險比 (Hazard Ratio, HR) —— 「生長勢/爆發力」的終極指標
在醫學上，Hazard 通常指「死亡風險」，但在本農業實驗的語境下，Hazard 代表的是「**突破現狀、發生事件（發芽/出土）的衝刺動能**」。它是透過 Cox 模型產出的核心數值。

*   **解讀範例**：若報告上顯示 `去芒組相對於未去芒組的 Hazard Ratio = 2.5`：
    *   **科學解釋**：代表在實驗觀察期內的**每一個瞬間**，只要這兩顆種子（一去芒、一未去芒）恰巧都還沒發芽，那「去芒種子在下一秒鐘順利發芽」的動能（Hazard），永遠都是未去芒種子的 **2.5 倍**。
    *   **科展白話文**：這句話的含金量很高。它不是只說去芒組最後發芽比較多，而是指去芒組在整個觀測週期中的「發芽積極度 / 生命爆發力」是未去芒組的 2.5 倍！
    *   **判讀標準**：如果 **HR > 1**，代表該處理有正向推進（加速）作用；如果 **HR < 1**，則代表該處理其實是一種阻力（會拖累或抑制生長）。

### 💡 低發芽率（低於 50%）時的觀察重點
1.  優先分析 **Log-rank Test** 的 P 值。
2.  比較兩組的 **GRI** 與 **MGT**。
3.  利用 **$T_{25}$** 判斷發芽初期的爆發力差異。

### 5. 覆土出苗實驗專有指標 (Emergence Metrics)
當進行 1cm 覆土實驗 (Experiment 2) 時，所有的「發芽 (Germination)」概念皆轉化為「出苗/破土 (Emergence)」：
*   **最終出苗率 (Final Emergence Percentage, FEP)**：種子不僅發芽，且幼苗成功頂破土壤表面被鏡頭捕捉到的絕對比例。
*   **出苗速率指數 (Emergence Rate Index, ERI)**：對應發芽實驗的 GRI，衡量破土的速度與整齊度。
*   **平均出苗時間 (Mean Emergence Time, MET)**：僅計算那些「成功破土」的種子，平均需花費多少小時鑽出土表。代表幼苗克服土壤阻力的平均時間成本。

### 6. 雙實驗交叉比對圖表解讀 (Cross-Experiment Overlay Analysis)
在分析腳本輸出的 `cross_experiment_overlay.png` 對比圖中，我們將「無阻力發芽（紙巾，虛線）」與「1cm覆土出苗（實線）」繪製於同一張累積成功率（發芽/出土）圖表上，它的核心價值在於觀測兩種落差：

1.  **水平落差 = 出土延遲 (Emergence Delay)**
    *   **觀察方式**：同一種處理（如同為橘色的去芒組），虛線(紙巾)與實線(土壤)在橫軸(時間)上的距離。
    *   **科學意義**：這段時間差，精確量化了「幼苗在 1cm 土壤中努力向上生長、克服摩擦力與重力」所耗費的額外時間。若去芒組的延遲時間較短，代表去芒有助於穿透土壤。

2.  **垂直落差 = 未能出土之比例 (Lethal Soil Zone / Vigor Loss)**
    *   **觀察方式**：曲線走到實驗終點時，虛線最高點與實線最高點的高度差。
    *   **科學意義**：假設紙巾發芽率為 90%，但覆土出苗率僅剩 60%，這 30% 的垂直落差代表「**這些種子雖然具備發芽能力，但缺乏足夠的生長勢 (Vigor) 或者遭遇過大阻力，導致未能順利頂越土壤而夭折**」。
    *   **科展核心論據**：若「去芒組(橘色)」的垂直落差顯著小於「未去芒組(藍色)」，便能強烈證明冠芒在土壤攀爬過程中扮演了致命的「阻力」角色。這利用兩個實驗的**能量損耗(死亡率)差**，給出了超越單一 ANOVA 檢定、最具視覺說服力的生物物理學結論！
